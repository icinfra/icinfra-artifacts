<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="slurm安装" /><meta property="og:locale" content="en" /><meta name="description" content="提前并运行munge 1 2 [root@offline-almalinux8-193-computing slurm-23.11.0]# ./configure --prefix=/tools/OSS/Slurm/23.11.0 --with-munge [root@offline-almalinux8-193-computing slurm-23.11.0]# make &amp;&amp; make install" /><meta property="og:description" content="提前并运行munge 1 2 [root@offline-almalinux8-193-computing slurm-23.11.0]# ./configure --prefix=/tools/OSS/Slurm/23.11.0 --with-munge [root@offline-almalinux8-193-computing slurm-23.11.0]# make &amp;&amp; make install" /><link rel="canonical" href="https://icinfra.cn/posts/installing-slurm/" /><meta property="og:url" content="https://icinfra.cn/posts/installing-slurm/" /><meta property="og:site_name" content="IC Infra" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-11-29T03:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="slurm安装" /><meta name="twitter:site" content="@username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-11-29T03:00:00+00:00","datePublished":"2023-11-29T03:00:00+00:00","description":"提前并运行munge 1 2 [root@offline-almalinux8-193-computing slurm-23.11.0]# ./configure --prefix=/tools/OSS/Slurm/23.11.0 --with-munge [root@offline-almalinux8-193-computing slurm-23.11.0]# make &amp;&amp; make install","headline":"slurm安装","mainEntityOfPage":{"@type":"WebPage","@id":"https://icinfra.cn/posts/installing-slurm/"},"url":"https://icinfra.cn/posts/installing-slurm/"}</script><title>slurm安装 | IC Infra</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="IC Infra"><meta name="application-name" content="IC Infra"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.min.js?baseurl=&register=true" ></script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="https://cdn.jsdelivr.net/gh/icinfra/icinfra-artifacts-0001@artifacts/img/avatar.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">IC Infra</a><p class="site-subtitle fst-italic mb-0">Focused on building and optimizing stable and efficient IC design infrastructure, offering in-depth insights into cutting-edge tools, workflows, and automation techniques. Feel free to contact me.</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/discussions/" class="nav-link"> <i class="fa-fw fas fa-comments"></i> <span>DISCUSSIONS</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/wanlinwang" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="javascript:location.href = 'mailto:' + ['wanlin.wang','foxmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>slurm安装</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>slurm安装</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1701226800" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Nov 29, 2023 </time> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/wanlinwang">wanlinwang</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="929 words" > <em>5 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">slurm安装</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">Contents</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">slurm安装</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"><h1 id="提前并运行munge">提前并运行munge</h1><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="o">[</span>root@offline-almalinux8-193-computing slurm-23.11.0]# ./configure <span class="nt">--prefix</span><span class="o">=</span>/tools/OSS/Slurm/23.11.0 <span class="nt">--with-munge</span>
<span class="o">[</span>root@offline-almalinux8-193-computing slurm-23.11.0]# make <span class="o">&amp;&amp;</span> make <span class="nb">install</span>
</pre></table></code></div></div><h1 id="配置">配置</h1><p>到<a href="https://slurm.schedmd.com/configurator.html">Slurm Configuration Tool</a>定制，</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
</pre><td class="rouge-code"><pre><span class="c"># slurm.conf file generated by configurator.html.</span>
<span class="c"># Put this file on all nodes of your cluster.</span>
<span class="c"># See the slurm.conf man page for more information.</span>
<span class="c">#</span>
<span class="nv">ClusterName</span><span class="o">=</span>ic-design-cluster-001
<span class="nv">SlurmctldHost</span><span class="o">=</span>offline-almalinux8-193-computing.icinfra.cn
<span class="nv">SlurmctldHost</span><span class="o">=</span>offline-almalinux8-194-computing.icinfra.cn
<span class="c">#</span>
<span class="c">#DisableRootJobs=NO</span>
<span class="c">#EnforcePartLimits=NO</span>
<span class="c">#Epilog=</span>
<span class="c">#EpilogSlurmctld=</span>
<span class="c">#FirstJobId=1</span>
<span class="c">#MaxJobId=67043328</span>
<span class="c">#GresTypes=</span>
<span class="c">#GroupUpdateForce=0</span>
<span class="c">#GroupUpdateTime=600</span>
<span class="c">#JobFileAppend=0</span>
<span class="c">#JobRequeue=1</span>
<span class="c">#JobSubmitPlugins=lua</span>
<span class="c">#KillOnBadExit=0</span>
<span class="c">#LaunchType=launch/slurm</span>
<span class="c">#Licenses=foo*4,bar</span>
<span class="c">#MailProg=/bin/mail</span>
<span class="c">#MaxJobCount=10000</span>
<span class="c">#MaxStepCount=40000</span>
<span class="c">#MaxTasksPerNode=512</span>
<span class="c">#MpiDefault=</span>
<span class="c">#MpiParams=ports=#-#</span>
<span class="c">#PluginDir=</span>
<span class="c">#PlugStackConfig=</span>
<span class="c">#PrivateData=jobs</span>
<span class="nv">ProctrackType</span><span class="o">=</span>proctrack/cgroup
<span class="c">#Prolog=</span>
<span class="c">#PrologFlags=</span>
<span class="c">#PrologSlurmctld=</span>
<span class="c">#PropagatePrioProcess=0</span>
<span class="c">#PropagateResourceLimits=</span>
<span class="c">#PropagateResourceLimitsExcept=</span>
<span class="c">#RebootProgram=</span>
<span class="nv">ReturnToService</span><span class="o">=</span>1
<span class="nv">SlurmctldPidFile</span><span class="o">=</span>/var/run/slurmctld.pid
<span class="nv">SlurmctldPort</span><span class="o">=</span>6817
<span class="nv">SlurmdPidFile</span><span class="o">=</span>/var/run/slurmd.pid
<span class="nv">SlurmdPort</span><span class="o">=</span>6818
<span class="nv">SlurmdSpoolDir</span><span class="o">=</span>/var/spool/slurmd
<span class="nv">SlurmUser</span><span class="o">=</span>slurm
<span class="c">#SlurmdUser=root</span>
<span class="c">#SrunEpilog=</span>
<span class="c">#SrunProlog=</span>
<span class="nv">StateSaveLocation</span><span class="o">=</span>/var/spool/slurmctld
<span class="c">#SwitchType=</span>
<span class="c">#TaskEpilog=</span>
<span class="nv">TaskPlugin</span><span class="o">=</span>task/affinity,task/cgroup
<span class="c">#TaskProlog=</span>
<span class="c">#TopologyPlugin=topology/tree</span>
<span class="c">#TmpFS=/tmp</span>
<span class="c">#TrackWCKey=no</span>
<span class="c">#TreeWidth=</span>
<span class="c">#UnkillableStepProgram=</span>
<span class="c">#UsePAM=0</span>
<span class="c">#</span>
<span class="c">#</span>
<span class="c"># TIMERS</span>
<span class="c">#BatchStartTimeout=10</span>
<span class="c">#CompleteWait=0</span>
<span class="c">#EpilogMsgTime=2000</span>
<span class="c">#GetEnvTimeout=2</span>
<span class="c">#HealthCheckInterval=0</span>
<span class="c">#HealthCheckProgram=</span>
<span class="nv">InactiveLimit</span><span class="o">=</span>0
<span class="nv">KillWait</span><span class="o">=</span>30
<span class="c">#MessageTimeout=10</span>
<span class="c">#ResvOverRun=0</span>
<span class="nv">MinJobAge</span><span class="o">=</span>300
<span class="c">#OverTimeLimit=0</span>
<span class="nv">SlurmctldTimeout</span><span class="o">=</span>120
<span class="nv">SlurmdTimeout</span><span class="o">=</span>300
<span class="c">#UnkillableStepTimeout=60</span>
<span class="c">#VSizeFactor=0</span>
<span class="nv">Waittime</span><span class="o">=</span>0
<span class="c">#</span>
<span class="c">#</span>
<span class="c"># SCHEDULING</span>
<span class="c">#DefMemPerCPU=0</span>
<span class="c">#MaxMemPerCPU=0</span>
<span class="c">#SchedulerTimeSlice=30</span>
<span class="nv">SchedulerType</span><span class="o">=</span>sched/backfill
<span class="nv">SelectType</span><span class="o">=</span><span class="k">select</span>/cons_tres
<span class="c">#</span>
<span class="c">#</span>
<span class="c"># JOB PRIORITY</span>
<span class="c">#PriorityFlags=</span>
<span class="c">#PriorityType=priority/multifactor</span>
<span class="c">#PriorityDecayHalfLife=</span>
<span class="c">#PriorityCalcPeriod=</span>
<span class="c">#PriorityFavorSmall=</span>
<span class="c">#PriorityMaxAge=</span>
<span class="c">#PriorityUsageResetPeriod=</span>
<span class="c">#PriorityWeightAge=</span>
<span class="c">#PriorityWeightFairshare=</span>
<span class="c">#PriorityWeightJobSize=</span>
<span class="c">#PriorityWeightPartition=</span>
<span class="c">#PriorityWeightQOS=</span>
<span class="c">#</span>
<span class="c">#</span>
<span class="c"># LOGGING AND ACCOUNTING</span>
<span class="c">#AccountingStorageEnforce=0</span>
<span class="c">#AccountingStorageHost=</span>
<span class="c">#AccountingStoragePass=</span>
<span class="c">#AccountingStoragePort=</span>
<span class="c">#AccountingStorageType=</span>
<span class="c">#AccountingStorageUser=</span>
<span class="c">#AccountingStoreFlags=</span>
<span class="c">#JobCompHost=</span>
<span class="c">#JobCompLoc=</span>
<span class="c">#JobCompParams=</span>
<span class="c">#JobCompPass=</span>
<span class="c">#JobCompPort=</span>
<span class="nv">JobCompType</span><span class="o">=</span>jobcomp/none
<span class="c">#JobCompUser=</span>
<span class="c">#JobContainerType=</span>
<span class="nv">JobAcctGatherFrequency</span><span class="o">=</span>30
<span class="c">#JobAcctGatherType=</span>
<span class="nv">SlurmctldDebug</span><span class="o">=</span>info
<span class="nv">SlurmctldLogFile</span><span class="o">=</span>/var/log/slurmctld.log
<span class="nv">SlurmdDebug</span><span class="o">=</span>info
<span class="nv">SlurmdLogFile</span><span class="o">=</span>/var/log/slurmd.log
<span class="c">#SlurmSchedLogFile=</span>
<span class="c">#SlurmSchedLogLevel=</span>
<span class="c">#DebugFlags=</span>
<span class="c">#</span>
<span class="c">#</span>
<span class="c"># POWER SAVE SUPPORT FOR IDLE NODES (optional)</span>
<span class="c">#SuspendProgram=</span>
<span class="c">#ResumeProgram=</span>
<span class="c">#SuspendTimeout=</span>
<span class="c">#ResumeTimeout=</span>
<span class="c">#ResumeRate=</span>
<span class="c">#SuspendExcNodes=</span>
<span class="c">#SuspendExcParts=</span>
<span class="c">#SuspendRate=</span>
<span class="c">#SuspendTime=</span>
<span class="c">#</span>
<span class="c">#</span>
<span class="c"># COMPUTE NODES</span>
<span class="nv">NodeName</span><span class="o">=</span>offline-almalinux8-19[5-7]-computing.icinfra.cn <span class="nv">State</span><span class="o">=</span>UNKNOWN
<span class="nv">PartitionName</span><span class="o">=</span>debug <span class="nv">Nodes</span><span class="o">=</span>ALL <span class="nv">Default</span><span class="o">=</span>YES <span class="nv">MaxTime</span><span class="o">=</span>INFINITE <span class="nv">State</span><span class="o">=</span>UP
</pre></table></code></div></div><h1 id="运行controller">运行Controller</h1><p>前台运行，看是否有报错</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="o">[</span>cloud-user@offline-almalinux8-193-computing ~]<span class="nv">$ </span><span class="nb">sudo</span> /tools/OSS/Slurm/23.11.0/sbin/slurmctld <span class="nt">-D</span>
slurmctld: fatal: <span class="nb">mkdir</span><span class="o">(</span>/var/spool/slurmctld<span class="o">)</span>: Permission denied
</pre></table></code></div></div><p>提示无权限，这里创建并修改owner，</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">[</span>cloud-user@offline-almalinux8-193-computing ~]<span class="nv">$ </span><span class="nb">sudo mkdir</span> /var/spool/slurmctld <span class="o">&amp;&amp;</span> <span class="nb">sudo chown </span>slurm /var/spool/slurmctld
</pre></table></code></div></div><p>前台运行</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="o">[</span>cloud-user@offline-almalinux8-193-computing ~]<span class="nv">$ </span><span class="nb">sudo</span> /tools/OSS/Slurm/23.11.0/sbin/slurmctld <span class="nt">-D</span>
slurmctld: error: Configured MailProg is invalid
slurmctld: slurmctld version 23.11.0 started on cluster ic-design-cluster-001
slurmctld: error: _shutdown_bu_thread:send/recv offline-almalinux8-194-computing.icinfra.cn: Connection refused
slurmctld: No memory enforcing mechanism configured.
slurmctld: error: Could not open node state file /var/spool/slurmctld/node_state: No such file or directory
slurmctld: error: NOTE: Trying backup state save file. Information may be lost!
slurmctld: No node state file <span class="o">(</span>/var/spool/slurmctld/node_state.old<span class="o">)</span> to recover
slurmctld: error: Could not open job state file /var/spool/slurmctld/job_state: No such file or directory
slurmctld: error: NOTE: Trying backup state save file. Jobs may be lost!
slurmctld: No job state file <span class="o">(</span>/var/spool/slurmctld/job_state.old<span class="o">)</span> to recover
slurmctld: <span class="k">select</span>/cons_tres: select_p_node_init: <span class="k">select</span>/cons_tres SelectTypeParameters not specified, using default value: CR_Core_Memory
slurmctld: <span class="k">select</span>/cons_tres: part_data_create_array: <span class="k">select</span>/cons_tres: preparing <span class="k">for </span>1 partitions
slurmctld: error: Could not open reservation state file /var/spool/slurmctld/resv_state: No such file or directory
slurmctld: error: NOTE: Trying backup state save file. Reservations may be lost
slurmctld: No reservation state file <span class="o">(</span>/var/spool/slurmctld/resv_state.old<span class="o">)</span> to recover
slurmctld: error: Could not open trigger state file /var/spool/slurmctld/trigger_state: No such file or directory
slurmctld: error: NOTE: Trying backup state save file. Triggers may be lost!
slurmctld: No trigger state file <span class="o">(</span>/var/spool/slurmctld/trigger_state.old<span class="o">)</span> to recover
slurmctld: Reinitializing job accounting state
slurmctld: <span class="k">select</span>/cons_tres: select_p_reconfigure: <span class="k">select</span>/cons_tres: reconfigure
slurmctld: <span class="k">select</span>/cons_tres: part_data_create_array: <span class="k">select</span>/cons_tres: preparing <span class="k">for </span>1 partitions
slurmctld: Running as primary controller
</pre></table></code></div></div><p>后台运行</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">[</span>cloud-user@offline-almalinux8-193-computing ~]<span class="nv">$ </span><span class="nb">sudo</span> /tools/OSS/Slurm/23.11.0/sbin/slurmctld
</pre></table></code></div></div><h1 id="运行database">运行Database</h1><p>略</p><h1 id="运行compute-nodes">运行Compute Nodes</h1><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">[</span>cloud-user@offline-almalinux8-193-computing ~]<span class="nv">$ </span><span class="nb">sudo</span> /tools/OSS/Slurm/23.11.0/sbin/slurmctld
</pre></table></code></div></div><h1 id="使用">使用</h1><h2 id="查看任务队列"><span class="me-2">查看任务队列</span><a href="#查看任务队列" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="o">[</span>cloud-user@offline-almalinux8-197-computing ~]<span class="nv">$ </span>/tools/OSS/Slurm/23.11.0/bin/squeue 
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST<span class="o">(</span>REASON<span class="o">)</span>
                 2     debug     wrap cloud-us  R    1:27:49      1 offline-almalinux8-195-computing.icinfra.cn
</pre></table></code></div></div><h2 id="查看slurm集群信息"><span class="me-2">查看Slurm集群信息</span><a href="#查看slurm集群信息" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="o">[</span>cloud-user@offline-almalinux8-197-computing ~]<span class="nv">$ </span>/tools/OSS/Slurm/23.11.0/bin/sinfo 
PARTITION AVAIL  TIMELIMIT  NODES  STATE NODELIST
debug<span class="k">*</span>       up   infinite      1  alloc offline-almalinux8-195-computing.icinfra.cn
debug<span class="k">*</span>       up   infinite      2   idle offline-almalinux8-196-computing.icinfra.cn,offline-almalinux8-197-computing.icinfra.cn
<span class="o">[</span>cloud-user@offline-almalinux8-194-computing ~]<span class="nv">$ </span>/tools/OSS/Slurm/23.11.0/bin/sinfo <span class="nt">-Nl</span>
Tue Nov 28 23:53:20 2023
NODELIST                                     NODES PARTITION       STATE CPUS    S:C:T MEMORY TMP_DISK WEIGHT AVAIL_FE REASON              
offline-almalinux8-195-computing.icinfra.cn      1    debug<span class="k">*</span>   allocated 1       1:1:1      1        0      1   <span class="o">(</span>null<span class="o">)</span> none                
offline-almalinux8-196-computing.icinfra.cn      1    debug<span class="k">*</span>   allocated 1       1:1:1      1        0      1   <span class="o">(</span>null<span class="o">)</span> none                
offline-almalinux8-197-computing.icinfra.cn      1    debug<span class="k">*</span>        idle 1       1:1:1      1        0      1   <span class="o">(</span>null<span class="o">)</span> none   
</pre></table></code></div></div><h2 id="提交作业"><span class="me-2">提交作业</span><a href="#提交作业" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">[</span>cloud-user@offline-almalinux8-197-computing ~]<span class="nv">$ </span>/tools/OSS/Slurm/23.11.0/bin/sbatch <span class="nt">--wrap</span><span class="o">=</span><span class="s2">"sleep 36000"</span>
</pre></table></code></div></div><h2 id="查看作业"><span class="me-2">查看作业</span><a href="#查看作业" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="o">[</span>cloud-user@offline-almalinux8-197-computing ~]<span class="nv">$ </span>/tools/OSS/Slurm/23.11.0/bin/sstat 2
JobID         MaxVMSize  MaxVMSizeNode  MaxVMSizeTask  AveVMSize     MaxRSS MaxRSSNode MaxRSSTask     AveRSS MaxPages MaxPagesNode   MaxPagesTask   AvePages     MinCPU MinCPUNode MinCPUTask     AveCPU   NTasks AveCPUFreq ReqCPUFreqMin ReqCPUFreqMax ReqCPUFreqGov ConsumedEnergy  MaxDiskRead MaxDiskReadNode MaxDiskReadTask  AveDiskRead MaxDiskWrite MaxDiskWriteNode MaxDiskWriteTask AveDiskWrite TRESUsageInAve TRESUsageInMax TRESUsageInMaxNode TRESUsageInMaxTask TRESUsageInMin TRESUsageInMinNode TRESUsageInMinTask TRESUsageInTot TRESUsageOutAve TRESUsageOutMax TRESUsageOutMaxNode TRESUsageOutMaxTask TRESUsageOutMin TRESUsageOutMinNode TRESUsageOutMinTask TRESUsageOutTot 
<span class="nt">------------</span> <span class="nt">----------</span> <span class="nt">--------------</span> <span class="nt">--------------</span> <span class="nt">----------</span> <span class="nt">----------</span> <span class="nt">----------</span> <span class="nt">----------</span> <span class="nt">----------</span> <span class="nt">--------</span> <span class="nt">------------</span> <span class="nt">--------------</span> <span class="nt">----------</span> <span class="nt">----------</span> <span class="nt">----------</span> <span class="nt">----------</span> <span class="nt">----------</span> <span class="nt">--------</span> <span class="nt">----------</span> <span class="nt">-------------</span> <span class="nt">-------------</span> <span class="nt">-------------</span> <span class="nt">--------------</span> <span class="nt">------------</span> <span class="nt">---------------</span> <span class="nt">---------------</span> <span class="nt">------------</span> <span class="nt">------------</span> <span class="nt">----------------</span> <span class="nt">----------------</span> <span class="nt">------------</span> <span class="nt">--------------</span> <span class="nt">--------------</span> <span class="nt">------------------</span> <span class="nt">------------------</span> <span class="nt">--------------</span> <span class="nt">------------------</span> <span class="nt">------------------</span> <span class="nt">--------------</span> <span class="nt">---------------</span> <span class="nt">---------------</span> <span class="nt">-------------------</span> <span class="nt">-------------------</span> <span class="nt">---------------</span> <span class="nt">-------------------</span> <span class="nt">-------------------</span> <span class="nt">---------------</span>
</pre></table></code></div></div><h1 id="参考资料">参考资料</h1><p>https://slurm.schedmd.com/quickstart_admin.html#build_install #slurm的构建与安装</p><p>https://www.icinfra.cn/blog/2023/setting-up-munge-on-almalinux8/ #munge的安装</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/icenv/">icenv</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/slurm/" class="post-tag no-text-decoration" >slurm</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=slurm%E5%AE%89%E8%A3%85%20-%20IC%20Infra&url=https%3A%2F%2Ficinfra.cn%2Fposts%2Finstalling-slurm%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fa-brands fa-square-x-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=slurm%E5%AE%89%E8%A3%85%20-%20IC%20Infra&u=https%3A%2F%2Ficinfra.cn%2Fposts%2Finstalling-slurm%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Ficinfra.cn%2Fposts%2Finstalling-slurm%2F&text=slurm%E5%AE%89%E8%A3%85%20-%20IC%20Infra" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div><div class="payment-info mt-5 text-center"><h4>支持创作者</h4><p>如果本文帮助到你，可以通过以下收款码支持我：</p><a href="https://cdn.jsdelivr.net/gh/icinfra/icinfra-artifacts-0001@artifacts/img/qrcode.jpg" class="popup img-link img-fluid shimmer"><img src="https://cdn.jsdelivr.net/gh/icinfra/icinfra-artifacts-0001@artifacts/img/qrcode.jpg" alt="收款码" style="max-width: 300px;" loading="lazy"></a><p>感谢你的支持！</p></div></div></article><script src="https://cdn.jsdelivr.net/npm/mermaid@11.6.0/dist/mermaid.min.js"></script> <script> document.addEventListener('DOMContentLoaded', function() { mermaid.initialize({ startOnLoad: true, theme: "default" }); // 既支持 language-mermaid 也支持 mermaid 类 window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid, .mermaid')); }); </script></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/toggle-layers-visibility/">Toggle Layers Visibility</a><li class="text-truncate lh-lg"> <a href="/posts/cadence-eda-downloader-user-guide/">Cadence EDA Downloader User Guide </a><li class="text-truncate lh-lg"> <a href="/posts/privacy-policy-for-cadence-eda-downloader/">Privacy Policy for Cadence EDA Downloader</a><li class="text-truncate lh-lg"> <a href="/posts/cadence-support-downloader-privacy-policy/">Cadence Support Downloader: Privacy Policy</a><li class="text-truncate lh-lg"> <a href="/posts/Lumerical-job-scheduler-integration-Slurm-Torque-LSF-SGE/">Lumerical job scheduler integration (Slurm, Torque, LSF, SGE) </a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/formatting/">formatting</a> <a class="post-tag btn btn-outline-primary" href="/tags/post/">post</a> <a class="post-tag btn btn-outline-primary" href="/tags/python/">python</a> <a class="post-tag btn btn-outline-primary" href="/tags/linux/">linux</a> <a class="post-tag btn btn-outline-primary" href="/tags/analog/">analog</a> <a class="post-tag btn btn-outline-primary" href="/tags/ipa/">ipa</a> <a class="post-tag btn btn-outline-primary" href="/tags/links/">links</a> <a class="post-tag btn btn-outline-primary" href="/tags/lsf/">lsf</a> <a class="post-tag btn btn-outline-primary" href="/tags/eda/">eda</a> <a class="post-tag btn btn-outline-primary" href="/tags/license/">license</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/chatgpr-improve-memory/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1744300800" data-df="ll" > Apr 10, 2025 </time><h4 class="pt-0 my-2">ChatGPT improve memory</h4><div class="text-muted"><p></p></div></div></a></article><article class="col"> <a href="/posts/svn-directory-rename-failed/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1744041600" data-df="ll" > Apr 7, 2025 </time><h4 class="pt-0 my-2">SVN Directory rename failed</h4><div class="text-muted"><p>如上图所示，在Repo-browser里修改好，然后在本地update就可以了。</p></div></div></a></article><article class="col"> <a href="/posts/vscode-agent-mode/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1743955200" data-df="ll" > Apr 6, 2025 </time><h4 class="pt-0 my-2">VSCode Agent Mode is Rolling Out to All VS Code Users</h4><div class="text-muted"><p>作为一名开发者，我最近在 Visual Studio Code（VSCode）中体验了 GitHub Copilot 的 Agent 模式，收获颇丰。 启用 Agent 模式 首先，我确保使用的是 VSCode Insiders 版本，并安装了 GitHub Copilot Chat 的预发布扩展。在设置中，我启用了 Copilot 的 Agent 模式。 使用体验 在实际使用中...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/ssh-over-squid-proxy/" class="btn btn-outline-primary" aria-label="Older" ><p>git ssh通过squid proxy访问</p></a> <a href="/posts/how-to-enable-newly-added-group-on-existing-linux-desktop/" class="btn btn-outline-primary" aria-label="Newer" ><p>How To Enable Newly Added Group On Existing Linux Desktop</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://github.com/wanlinwang">wanlinwang</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Rights reserved.</span></p><p></p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/formatting/">formatting</a> <a class="post-tag btn btn-outline-primary" href="/tags/post/">post</a> <a class="post-tag btn btn-outline-primary" href="/tags/python/">python</a> <a class="post-tag btn btn-outline-primary" href="/tags/linux/">linux</a> <a class="post-tag btn btn-outline-primary" href="/tags/analog/">analog</a> <a class="post-tag btn btn-outline-primary" href="/tags/ipa/">ipa</a> <a class="post-tag btn btn-outline-primary" href="/tags/links/">links</a> <a class="post-tag btn btn-outline-primary" href="/tags/lsf/">lsf</a> <a class="post-tag btn btn-outline-primary" href="/tags/eda/">eda</a> <a class="post-tag btn btn-outline-primary" href="/tags/license/">license</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> (function () { const themeMapper = Theme.getThemeMapper('light', 'dark_dimmed'); const initTheme = themeMapper[Theme.visualState]; let lang = 'en';if (lang.length > 2 && !lang.startsWith('zh')) { lang = lang.slice(0, 2); } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'icinfra/icinfra-discussions', 'data-repo-id': 'R_kgDOOURp_w', 'data-category': 'Q&A', 'data-category-id': 'DIC_kwDOOURp_84Coy9P', 'data-mapping': 'pathname', 'data-strict' : '1', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'bottom', 'data-lang': lang, 'data-loading': 'lazy', crossorigin: 'anonymous', async: '' }; let giscusNode = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusNode.setAttribute(key, value) ); const $footer = document.querySelector('footer'); $footer.insertAdjacentElement("beforebegin", giscusNode); addEventListener('message', (event) => { if (event.source === window && event.data && event.data.id === Theme.ID) { const newTheme = themeMapper[Theme.visualState]; const message = { setConfig: { theme: newTheme } }; const giscus = document.getElementsByClassName('giscus-frame')[0].contentWindow; giscus.postMessage({ giscus: message }, 'https://giscus.app'); } }); })(); </script> <script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
